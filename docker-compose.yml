version: '3.8'

services:
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
    command: redis-server --appendonly yes

  worker:
    build:
      context: ./worker
      dockerfile: Dockerfile
    env_file:
      - ./worker/.env
    depends_on:
      - redis
    restart: unless-stopped
    extra_hosts:
      - "host.docker.internal:host-gateway"
  # Uncomment when ready to use:
  # playwright-grid:
  #   image: playwright:latest
  #   ports:
  #     - "4444:4444"
  #   environment:
  #     - GRID_URL=http://playwright-grid:4444
  #
  # appium:
  #   image: appium/appium:latest
  #   ports:
  #     - "4723:4723"
  #   environment:
  #     - APPIUM_PORT=4723

volumes:
  redis-data:


